<!DOCTYPE html>
<html lang="pl">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, initial-scale=1">
    <link rel="stylesheet"
          href="https://www.w3schools.com/w3css/4/w3.css">
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="stylesheet"
          href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
    <title>
      Tytuł strony / Page Title
    </title>
    <style>
      .slide {
        display: none;
      }
          
      .w3-arrow, .w3-tag {
        cursor: pointer;
      }

      .w3-tag {
        height: 4px;
        width: 40px; 
        padding: 0;
      }

      .my_td {
        border: 1px solid #000; 
        padding: 15px;
        text-align: left;
      }
      
      .my_th {
        background-color: #04AA6D;
        padding: 8px;
        color: white;
        font-weight: bold;
      }

      .my_butt {
        padding: 8px;
        margin: 4px;
        width: 100%;
      }

      .my_tab {
        margin: 8px auto;
      }

      pre { /* copied h2 default style settings */
        display: block;
        font-size: 1.5em;
        margin-block-start: 0.83em;
        margin-block-end: 0.83em;
        margin-inline-start: 0px;
        margin-inline-end: 0px;
        font-weight: bold;
        unicode-bidi: isolate;
      }
    </style>
  </head>
  <body>
    <header class="w3-bar w3-pale-yellow w3-padding-small w3-cell-row w3-margin-bottom">
      <div class="w3-col m6">
        <div class="w3-bar-item w3-cell w3-cell-middle">
          <img src="images/logo.png" alt="USOS application logo"/>
        </div>
        <div class="w3-bar-item w3-large">Wyższa szkoła informatyki</div>
        <div class="w3-dropdown-hover w3-hide-small">
          <button class="w3-button w3-hover-pale-yellow w3-pale-yellow">Studia</button>
          <div class="w3-dropdown-content w3-bar-block w3-round-large w3-card-4">
            <a href="#" class="w3-bar-item w3-button">Stacjonarne</a>
            <a href="#" class="w3-bar-item w3-button w3-border-bottom">Niestacjonarne</a>
            <a href="#" class="w3-bar-item w3-button">Informatyka</a>
            <a href="#" class="w3-bar-item w3-button">Webmastering</a>
          </div>
        </div>
        <button id="hide_button" class="w3-button w3-pale-yellow w3-right w3-hide-medium w3-hide-large">&#9776;</button>
      </div>
      <div class="w3-col m5 w3-hide-small">
        <input type="text" class="w3-bar-item w3-input w3-margin-right w3-round-large" placeholder="Szukaj">
        <a href="#" class="w3-bar-item w3-button w3-border w3-round-large w3-text-gray">Szukaj</a>
      </div>
      <div class="w3-col m1 w3-hide-small w3-right-align">
        <p>USOS</p>
      </div>
      <div class="w3-hide-large w3-hide-medium w3-cell-row" id="myNavBar" style="display: none">
        <div class="w3-margin-bottom w3-col s12">
          <button id="studies_button" class="w3-button w3-block w3-hover-pale-yellow w3-pale-yellow w3-left-align">Studia</button>
          <div id="studies" class="w3-white w3-container w3-hide w3-margin-right">
            <div><a href="#" class="w3-button">Stacjonarne</a></div>
            <div class=" w3-border-bottom"><a href="#" class="w3-button">Niestacjonarne</a></div>
            <div><a href="#" class="w3-button">Informatyka</a></div>
            <div><a href="#" class="w3-button">Webmastering</a></div>
          </div>
        </div>
        <div class="w3-margin-bottom w3-col s12">
          <input type="text" class="w3-bar-item w3-input w3-round-large" placeholder="Szukaj">
          <a href="#" class="w3-button w3-border w3-round-large w3-text-gray w3-right">Szukaj</a>
        </div>
        <div class="w3-margin-bottom w3-col s12">USOS</div>
      </div> 
    </header>

    <div style="margin:16px">
      <h2>Dostępne operacje:</h2>
      <ul>
        <li>Wyświetlenie wykazu ocen dla wybranego studenta</li>
        <li>Dodanie, modyfikacja lub usunięcie oceny</li>
      </ul>

      <form id="students_form" action="http://localhost:8000/student" method="GET">
        <h3>Formularz dla wykazu ocen studentów</h3>
        <p>
          Kliknij na panel danego studenta, aby zobaczyć wykaz jego ocen:
        </p>
      </form>

      <h3>Wykaz przedmiotów</h3>
      <ul id="courses_list"></ul>

      <h3>Formularz dla operacji dodania, modyfikowania lub usuwania oceny</h3>
      <div id="student_card" ondrop="handleDrop(event)" ondragover="handleDragover(event)" style="height: 100px; text-align: center; border: 1px solid #000">
        <h4>
          Karta studenta - przeciągnij tu prawidłowo wypełnioną kartę operacji, aby ją wykonać!
        </h4>
      </div>

      <div id="operation_card" draggable="true" ondragstart="handleDragstart(event)" style="margin-top: 16px; padding: 8px; border: 1px solid #000">
        <h4>
          Karta operacji - wypełnij formularz i przeciągnij kartę operacji na kartę studenta!
        </h4><br>
        <form id="op_form">
          <label for="student">Id studenta:</label>
          <input type="text" name="student" id="student">&nbsp; &nbsp; &nbsp;

          <label for="subject">Id przedmiotu:</label>
          <input type="text" name="subject" id="subject"><br><br>

          <label for="grade">Dodawana / zmodyfikowana ocena:</label>
          <input type="text" name="grade" id="grade">&nbsp; &nbsp; &nbsp;

          <label for="index">Indeks modyfikowanej / usuwanej oceny:</label>
          <input type="text" name="index" id="index"><br><br> 

          <label for="op">Rodzaj operacji: 'ADD', 'MODIFY' albo 'DELETE':</label>
          <input type="text" name="op" id="op">&nbsp; &nbsp; &nbsp;

          <label for="type">Typ zwracanych danych: 'JSON' albo 'XML':</label>
          <input type="text" name="type" id="type"><br><br>
        </form>
      </div>

      <h3>Tutaj pojawią się dane dotyczące operacji, zwrócone w zażądanym formacie:</h3>
      <div id="result_div"></div>
    </div>
    
    <div class="w3-margin-left w3-margin-right">
      <div class="w3-container w3-gray w3-text-white w3-row" style="margin: 0 4.5%;">
        <div id="minus_slide" class="w3-col w3-arrow w3-xlarge" style="margin-top:75px; width:1%;">&#10094;</div>
        <div class="w3-col" style="height: 155px; width:98%">
          <div class="slide w3-center w3-animate-right">
            <div class="w3-large">Studia z przyszłością</div>
            <img src="images/przyszlosc.png" alt="group of reasonable students">
          </div>
          <div class="slide w3-center w3-animate-right">
            <div class="w3-large">Aplikuj już dziś</div>
            <img src="images/nie_spij.png" alt="sleeping student, missing opportunities"><br>
            Nie śpij, bo Cię inni ubiegną
          </div>
          <div class="slide w3-center w3-animate-right">
            <div class="w3-large">Promocja</div>
            Pierwszy semestr za darmo dla losowych 10 osób
          </div>
        </div>
        <div id="plus_slide" class="w3-col w3-arrow w3-xlarge" style="margin-top:75px; width:1%">&#10095;</div>
        <div class="w3-center w3-container" style="margin: 8px 0; width:100%;">
          <span id="tag1" class="w3-tag w3-border w3-transparent w3-hover-white"></span>
          <span id="tag2" class="w3-tag w3-border w3-transparent w3-hover-white"></span>
          <span id="tag3" class="w3-tag w3-border w3-transparent w3-hover-white"></span>
        </div>
      </div>
    </div>
    <div class="w3-row" style="margin: 16px 3.2%;">
      <div class="w3-col m6 l4">
        <div class="w3-margin-left w3-margin-right w3-pale-red w3-card">
          <div class="w3-padding w3-border-bottom w3-margin-bottom">
            Oferty zatrudnienia
          </div>
          <div class="w3-container">
            <div class="w3-center">
              <img src="images/oferty.png" alt="two happy girl graduates" width="100%"/>
            </div>
            <div class="w3-margin-bottom">
              <ul class="w3-text-blue">
                <li><a href="#">Google</a></li>
                <li><a href="#">IBM</a></li>
              </ul>
              <button class="w3-button w3-blue">Pozostałe oferty</button>
            </div>
          </div>
        </div>
      </div>
      <div class="w3-col m6 l4">
        <div class="w3-margin-left w3-margin-right w3-pale-green w3-card">
          <div class="w3-padding w3-border-bottom w3-margin-bottom">
            Kierunki
          </div>
          <div class="w3-container">
            <div class="w3-center">
              <img src="images/kierunki.png" alt="students sitting at a lecture" width="100%"/>
            </div>
            <div class="w3-padding-16">
              <table class="w3-table w3-striped" style="margin-bottom: 32px;">
                <tr class="w3-teal w3-text-black">
                  <th>Kierunek</th>
                  <th>Czesne</th>
                </tr>
                <tr>
                  <td>Informatyka</td>
                  <td>4000 zł / semestr</td>
                </tr>
                <tr>
                  <td>Webmastering</td>
                  <td>3500 zł / semestr</td>
                </tr>
              </table>
            </div>
          </div>
        </div>
      </div>
      <div class="w3-col m12 l4">
        <div class="w3-margin-left w3-margin-right w3-pale-blue w3-card">
          <div class="w3-padding w3-border-bottom w3-margin-bottom">
            Zaplecze dydaktyczne
          </div>
          <div class="w3-container">
            <div class="w3-center">
              <img src="images/zaplecze.png" alt="classroom full of high-class computers" width="100%"/>
            </div>
            <p style="margin-top: 4px; font-family:'Lucida Sans', 'Lucida Sans Regular', 'Lucida Grande', 'Lucida Sans Unicode', Geneva, Verdana, sans-serif;">
              Budynek został wyposażony w wysokiej klasy systemy telekonferencyjne.
              W czterech salach zostały zainstalowane urządzenia (C40 oraz C60) firmy
              TANDBERG umożliwiające przetwarzanie, kodowanie i przesyłanie obrazu
              w rozdzielczości 1080HD. W jednej z sal zainstalowano system Telepresence
              Dual 52".
            </p>
          </div>
        </div>
      </div>
    </div>
    <div style="height: 138px"></div>
      <div class="w3-bottom">
      <div class="w3-margin-left w3-margin-right w3-pale-yellow w3-padding-16">
        <footer class="w3-padding w3-cell-row">
          <div class="w3-col s5">
            <b>Adres siedziby:</b><br>
            Wyższa szkoła Informatyki<br>
            ul. Jana Bieleckiego 1<br>
            30-836 Kraków
          </div>
          <div class="w3-col s5">
            <b>Kontakt:</b><br>
            <i class="fa-solid fa-envelope-circle-check"></i>
            <a class="w3-text-blue" href=mailto:dziekanat@wsi.krakow.pl>dziekanat@wsi.krakow.pl</a><br>
            <i class="fa-solid fa-mobile-screen-button"></i>
            <a class="w3-text-blue" href=tel:+48-555-123-456>+48-555-123-456</a>
          </div>
          <div class="w3-col s2">
            <i class="fa-brands fa-facebook"></i>
            <i class="fa-brands fa-twitter"></i>
          </div>
        </footer>
      </div>
    </div>
    <script>
      var slideIndex = 1;
      var vis = false;
      var slides = document.getElementsByClassName("slide");
      var tags = document.getElementsByClassName("w3-tag");

      function changeNavBarDisplay() {
        if (vis == false) {
          document.getElementById("myNavBar").style.display = "block";
          vis = true;
        } else {
          document.getElementById("myNavBar").style.display = "none";
          vis = false;
        }
      }

      function changeStudiesDisplay(id) {
        var studies = document.getElementById(id);

        if (studies.className.indexOf("w3-show") == -1) {
          studies.className += " w3-show";
        } else {
          studies.className = studies.className.replace(" w3-show", "");
        }
      }

      function changeSlide(n) {
        showSlide((slideIndex += n));
      }

      function setCurrentSlide(n) {
        showSlide((slideIndex = n));
      }

      function showSlide(n) {
        var i;

        if (n > slides.length) {
          slideIndex = 1;
        }

        if (n < 1) {
          slideIndex = slides.length;
        }

        for (i = 0; i < slides.length; i++) {
          slides[i].style.display = "none";
        }

        for (i = 0; i < tags.length; i++) {
          tags[i].className = tags[i].className.replace(" w3-white", "");
        }

        slides[slideIndex - 1].style.display = "block";
        tags[slideIndex - 1].className += " w3-white";
      }

      function carousel() {
        var i;

        for (i = 0; i < slides.length; i++) {
          slides[i].style.display = "none";
        }

        for (i = 0; i < tags.length; i++) {
          tags[i].className = tags[i].className.replace(" w3-white", "");
        }

        slideIndex++;
        if (slideIndex > slides.length) {
          slideIndex = 1;
        }

        slides[slideIndex - 1].style.display = "block";
        tags[slideIndex - 1].className += " w3-white";
        setTimeout(carousel, 10000); // Change image every 10 seconds
      }

      function configureNavBar() {
        let studiesButton = document.getElementById("studies_button");
        studiesButton.addEventListener("click", function () {
          changeStudiesDisplay("studies");
        });

        let hideButton = document.getElementById("hide_button");
        hideButton.addEventListener("click", function () {
          changeNavBarDisplay();
        });
      }

      function configureSlider() {
        let minusSlide = document.getElementById("minus_slide");
        minusSlide.addEventListener("click", function () {
          changeSlide(-1);
        });

        let plusSlide = document.getElementById("plus_slide");
        plusSlide.addEventListener("click", function () {
          changeSlide(1);
        });

        for (let tag of tags) {
          let slideNum = Number(tag.getAttribute("id")[3]);
          tag.addEventListener("click", () => {
            setCurrentSlide(slideNum);
          });
        }
      }

      function getArgs(data) {
        let args;
        let student = data.student;
        let subject = data.subject;
        let grade = data.grade;
        let index = data.index;
        let op = data.op;
        let res_type = data.type;

        if (op === "ADD") {
          args = { student: student, subject: subject, grade: grade, type: res_type };
        } else if (op === "MODIFY") {
          args = { student: student, subject: subject, grade: grade, index: index, type: res_type };
        } else if (op === "DELETE") {
          args = { student: student, subject: subject, index: index, type: res_type };
        }

        return args;
      }

      function requestAJAX(http_method, response_type, args) {
        const xhr = new XMLHttpRequest();

        xhr.addEventListener("load", function (_evt) {
          if (xhr.status === 200) {
            let response = xhr.response;
            switch (response_type) {
              case "json":
                response = JSON.stringify(xhr.response, null, 4);
                break;

              case "document":
                let xmlTag = xhr.response.documentElement.nodeName;
                response = `<${xmlTag}>${xhr.response.documentElement.textContent}</${xmlTag}>`;
                break;

              default:
                break;
            }

            let result_div = document.getElementById("result_div");
            let pre = document.createElement("pre");
            pre.textContent = response;

            if (result_div.children.length > 0) {
              result_div.removeChild(result_div.lastChild);
            }

            result_div.appendChild(pre);
          }
        });

        xhr.addEventListener("error", function (evt) {
          window.alert("Wystąpił problem z żądaniem!");
        });

        xhr.responseType = response_type;

        if (http_method === "POST") {
          xhr.open("POST", "http://localhost:8000/teacher/add", true);
        }

        if (http_method === "PUT") {
          xhr.open("PUT", "http://localhost:8000/teacher/modify", true);
        }

        if (http_method === "DELETE") {
          xhr.open("DELETE", "http://localhost:8000/teacher/delete", true);
        }

        switch (response_type) {
          case "json":
            xhr.setRequestHeader("Accept", "application/json");
            break;
          case "document":
            xhr.setRequestHeader("Accept", "application/xml");
            break;
        }

        if (http_method === "POST") {
          xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
          xhr.send(`args=${encodeURIComponent(JSON.stringify(args))}`);
        }

        if (http_method === "PUT") {
          xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
          xhr.send(`args=${encodeURIComponent(JSON.stringify(args))}`);
        }

        if (http_method === "DELETE") {
          xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
          xhr.send(`args=${encodeURIComponent(JSON.stringify(args))}`);
        }
      }

      function handleDrop(ev) {
        ev.preventDefault();
        const data = JSON.parse(ev.dataTransfer.getData("text/plain"));
        if (["ADD", "MODIFY", "DELETE"].includes(data.op) && ["JSON", "XML"].includes(data.type)) {
          const methodDict = { "ADD": "POST", "MODIFY": "PUT", "DELETE": "DELETE" }; 
          requestAJAX(methodDict[data.op], data.type.toLowerCase(), getArgs(data))
        } else {
          window.alert("Niepoprawny rodzaj operacji lub żądany typ danych!");
        }
      }

      function handleDragover(ev) {
        ev.preventDefault();
        ev.dataTransfer.dropEffect = "copy";
      }

      function handleDragstart(ev) {
        let form = document.getElementById("op_form");

        let student = form.student.value;
        let subject = form.subject.value;
        let grade = form.grade.value;
        let index = form.index.value;
        let op = form.op.value;
        let res_type = form.type.value;

        let data = { student: student, subject: subject, grade: grade, index: index, op: op, type: res_type };

        ev.dataTransfer.setData("text/plain", JSON.stringify(data));
        ev.dataTransfer.effectAllowed = "copy";
      }

      configureNavBar();
      configureSlider();
      carousel();
      showSlide(slideIndex);
    </script>
    <script src="https://www.w3schools.com/lib/w3.js"></script>
    <script type="text/babel"></script>
  </body>
</html>
